
The exercise is solved by following the equations in lecture notes. 

A problem was encountered when calculating the diffuse contribution. By revising notes more carefully, we found out that an implicit constraints was missed at first, which is 'no illumination if dot(n, l)<0'. After adding an additional condition before calculation, this problem is solved.

The output pictures for each are in result file.

Workload distributed equally.